fileFormatVersion: 2
guid: 0c7fb49010cfda543861e7ae602ce6ca
importerOverride: ZEPETO.Script.Compiler:ZEPETO.Script:TypescriptAssetImporter
ScriptedImporter:
  internalIDToNameTable: []
  externalObjects: {}
  serializedVersion: 2
  userData: 
  assetBundleName: 
  assetBundleVariant: 
  script: {fileID: -1123457745, guid: 54cf806323ffe4418a4ce4cc63fe6b9d, type: 3}
  isAssemblyDeclarations: 0
  assembly: 
  generateAllTypes: 1
  types: []
  generateWrapper: 0
  overrideWrapperTypes: 0
  wrapperTypes: []
  WrapperFilters: []
  wrapperOutputDirectory: Generated
  compiledResult: '{"source":"\"use strict\";\r\nObject.defineProperty(exports, \"__esModule\",
    { value: true });\r\nconst ZEPETO_Script_1 = require(\"ZEPETO.Script\");\r\nconst
    UnityEngine_1 = require(\"UnityEngine\");\r\nconst Itemtransformable_1 = require(\"../Player/Itemtransformable\");\r\nconst
    UITransformableButton_1 = require(\"../UI/UITransformableButton\");\r\nconst
    MultiplayerPropHuntManager_1 = require(\"../Multiplayer/MultiplayerPropHuntManager\");\r\nconst
    ZEPETO_Character_Controller_1 = require(\"ZEPETO.Character.Controller\");\r\nconst
    NonHunterController_1 = require(\"../Player/NonHunterController\");\r\n// This
    function controls the way props transform into objects\r\nclass TransformableItemsManager
    extends ZEPETO_Script_1.ZepetoScriptBehaviour {\r\n    constructor() {\r\n       
    super(...arguments);\r\n        // List of the objects that will have the game
    \r\n        // Note: They are scriptable objects see this if you don''t are used
    to use them\r\n        // https://docs.zepeto.me/studio/reference/scriptableobject\r\n       
    this.itemsTransformablesSO = [];\r\n        // This map will contain a list of
    items for transform the player by the id of the item\r\n        this._allItemsTransformables
    = new Map();\r\n    }\r\n    Awake() {\r\n        // Singleton pattern\r\n       
    if (ZEPETO_Script_1.ZepetoScriptBehaviour.op_Inequality(TransformableItemsManager.instance,
    null))\r\n            UnityEngine_1.GameObject.Destroy(this.gameObject);\r\n       
    else\r\n            TransformableItemsManager.instance = this;\r\n        //
    Array initialization\r\n        this._allButtons = [];\r\n    }\r\n    Start()
    {\r\n        // Call to the function to instance the buttons for the props\r\n       
    this.InstantiateButtons();\r\n    }\r\n    // This function is responsible for
    instantiating, setting, and storing buttons in their array\r\n    InstantiateButtons()
    {\r\n        // The foreach is a loop to reach every item of an iterable variable\r\n       
    this.itemsTransformablesSO.forEach(element => {\r\n            // We instance
    the button and save a reference on a variable\r\n            let newUITransformableButton
    = UnityEngine_1.GameObject.Instantiate(this.uiTransformableButtonTemplate, this.transformableButtonsParent);\r\n           
    // We save a variable with the script of the button\r\n            let buttonScript
    = newUITransformableButton.GetComponent($typeof(UITransformableButton_1.default));\r\n           
    // Then we call at the function \"SetButton\" on the script\r\n            buttonScript.SetButton(element.targetObject);\r\n           
    // To finish we push the button script to the _allButtons array\r\n           
    this._allButtons.push(buttonScript);\r\n        });\r\n    }\r\n    // This function
    transforms the players who have decided to transform into an object\r\n    TransformPlayer(itemId,
    sessionId) {\r\n        // Call to a function to check if the item exist and
    return if it is not\r\n        if (!this.CheckItemExist(itemId))\r\n           
    return;\r\n        // Get a reference of the playerData that will be transform\r\n       
    let playerData = MultiplayerPropHuntManager_1.default.instance.GetPlayerData(sessionId);\r\n       
    // Get a reference of wich item will be transformed calling at the function GetItemAvailable\r\n       
    let tempItemTransfromablethis = this.GetItemAvailable(itemId);\r\n        //
    Check if the reference of the playerData is a hunter and if the item that previously
    got is not null\r\n        if (tempItemTransfromablethis && !playerData.isHunter)
    {\r\n            // Get reference of the zepetoPlayer that will be transformed\r\n           
    const zepetoPlayer = ZEPETO_Character_Controller_1.ZepetoPlayers.instance.GetPlayer(sessionId).character.gameObject;\r\n           
    // Get his NonHunterController component\r\n            let nonHunterScript =
    zepetoPlayer.GetComponent($typeof(NonHunterController_1.default));\r\n           
    // If we can get the component we call to the function to transform the player\r\n           
    if (nonHunterScript)\r\n                nonHunterScript.TransformIntoItem(tempItemTransfromablethis);\r\n       
    }\r\n    }\r\n    TransformLocalPlayer(itemId) {\r\n        MultiplayerPropHuntManager_1.default.instance.ChangeItem(itemId);\r\n   
    }\r\n    CheckItemExist(itemId) {\r\n        if (!this._allItemsTransformables.has(itemId))
    {\r\n            let exist = false;\r\n            this._allButtons.forEach(button
    => {\r\n                if (button._myItemTransformable.itemId == itemId) {\r\n                   
    this._allItemsTransformables.set(itemId, []);\r\n                    this.CreateNewItem(itemId);\r\n                   
    exist = true;\r\n                }\r\n            });\r\n            return exist;\r\n       
    }\r\n        else {\r\n            return true;\r\n        }\r\n    }\r\n   
    GetItemAvailable(itemId) {\r\n        let items = this._allItemsTransformables.get(itemId);\r\n       
    let item;\r\n        let itemAvailable = false;\r\n        for (let index = 0;
    index < items.length; index++) {\r\n            const currentItem = items[index];\r\n           
    if (!currentItem.activeSelf) {\r\n                item = currentItem;\r\n               
    itemAvailable = true;\r\n                break;\r\n            }\r\n        }\r\n       
    if (!itemAvailable) {\r\n            item = this.CreateNewItem(itemId);\r\n       
    }\r\n        return item;\r\n    }\r\n    CreateNewItem(itemId) {\r\n       
    let item;\r\n        this._allButtons.forEach(button => {\r\n            if (button._myItemTransformable.itemId
    == itemId) {\r\n                item = UnityEngine_1.GameObject.Instantiate(button._myItemTransformable.itemPrefab,
    this.transform);\r\n                item.SetActive(false);\r\n               
    this._allItemsTransformables.get(itemId).push(item);\r\n                let savedItems
    = this._allItemsTransformables.get(itemId);\r\n                this._allItemsTransformables.set(itemId,
    savedItems);\r\n                return item;\r\n            }\r\n        });\r\n       
    return item;\r\n    }\r\n}\r\nexports.default = TransformableItemsManager;\r\n//#
    sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiVHJhbnNmb3JtYWJsZUl0ZW1zTWFuYWdlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIlRyYW5zZm9ybWFibGVJdGVtc01hbmFnZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxpREFBNkU7QUFDN0UsNkNBQW9EO0FBQ3BELG1FQUEyRDtBQUMzRCx1RUFBZ0U7QUFDaEUsMEZBQW1GO0FBQ25GLDZFQUE0RDtBQUM1RCx1RUFBZ0U7QUFFaEUsOERBQThEO0FBQzlELE1BQXFCLHlCQUEwQixTQUFRLHFDQUFxQjtJQUE1RTs7UUFTSSwrQ0FBK0M7UUFDL0MsK0VBQStFO1FBQy9FLDJEQUEyRDtRQUNwRCwwQkFBcUIsR0FBZ0QsRUFBRSxDQUFDO1FBRS9FLHVGQUF1RjtRQUMvRSw0QkFBdUIsR0FBOEIsSUFBSSxHQUFHLEVBQXdCLENBQUM7SUFrSGpHLENBQUM7SUE5R0csS0FBSztRQUNELG9CQUFvQjtRQUNwQixJQTlCQyxxQ0FBcUIsQ0EwSW81QixhQUFjLENBNUdwN0IseUJBQXlCLENBQUMsUUFBUSxFQUFJLElBQUk7WUFBRSx3QkFBVSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7O1lBQy9FLHlCQUF5QixDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7UUFFL0MsdUJBQXVCO1FBQ3ZCLElBQUksQ0FBQyxXQUFXLEdBQUcsRUFBRSxDQUFDO0lBQzFCLENBQUM7SUFFRCxLQUFLO1FBQ0QsNkRBQTZEO1FBQzdELElBQUksQ0FBQyxrQkFBa0IsRUFBRSxDQUFDO0lBQzlCLENBQUM7SUFFRCw4RkFBOEY7SUFDdkYsa0JBQWtCO1FBQ3JCLG9FQUFvRTtRQUNwRSxJQUFJLENBQUMscUJBQXFCLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyxFQUFFO1lBQ3pDLDREQUE0RDtZQUM1RCxJQUFJLHdCQUF3QixHQUFHLHdCQUFVLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyw2QkFBNkIsRUFBRSxJQUFJLENBQUMsMEJBQTBC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","assetPath":"Assets/PropHunt_Template/_Scripts/Managers/TransformableItemsManager.ts","manifest":{"properties":[{"assembly":"UnityEngine.CoreModule","name":"uiTransformableButtonTemplate","type":"UnityEngine.GameObject","isArray":false,"initValue":[],"enumKeys":[],"enumValues":[],"attributes":[]},{"assembly":"UnityEngine.CoreModule","name":"transformableButtonsParent","type":"UnityEngine.Transform","isArray":false,"initValue":[],"enumKeys":[],"enumValues":[],"attributes":[]},{"assembly":"ZEPETO.Script","name":"itemsTransformablesSO","type":"ZEPETO.Script.ZepetoScriptableObject[]","isArray":true,"initValue":[],"enumKeys":[],"enumValues":[],"attributes":[]}],"name":"TransformableItemsManager","description":"","hasAnimatorMove":false},"isCompiled":true}'
  typescriptHash: 2dc05cea6ad1a79802ce5b9e23907ede
  onlyWriteTrigger: 0
